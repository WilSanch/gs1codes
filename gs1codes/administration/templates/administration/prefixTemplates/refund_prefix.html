{% extends 'administration/base.html' %}

{% block content %}  
    <form id="prefixrefund" action="" method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <h6 class="center">Devolución de códigos</h6>
        
        <div class="row">
            <div class="col s12">
              <div class="card grey lighten-4">
                <div class="card-content orange-text text-darken-4">
                  <i class="material-icons prefix">info_outline</i> Recuerde que no se puede llevar a cabo el proceso de devolución de un código en particular, debe hacerse la devolución de un prefijo completo.
                </div>
              </div>
            </div>
        </div>
  
        <div class="row">
            <div class="col s3">
                <label for="nit">Nit de la empresa</label>
                <input type="text" id="nit" name="nit" value="{{contexto.enterprise.identification}}" readonly required autocomplete="off">
            </div>
            <div class="col s9">
                <label for="name">Razón social</label>
                <input type="text" id="name" name="name" value="{{contexto.enterprise.enterprise_name}}" readonly>
            </div>
        </div>
        <div class="row">
            <label for="observation">Observaciones (*)</label>
            <textarea id="observation" name="observation" class="materialize-textarea" required></textarea>
        </div>
        <div class="row">
            <a class="btn waves-effect waves-light grey" href="{% url 'assignate_search_enterprise' %}?obj=2">Cambiar Empresa
                <i class="material-icons left">arrow_back</i>
            </a>
        </div>

        <input id="error" type="hidden" value="{{ contexto.Error }}">
    </form>
    
    <br><hr><br>
    <div style="white-space: nowrap; overflow-x:auto;" id="prefixTable">   
    </div>
    <br>
    <div style="white-space: nowrap;" id="codesTable">
    </div>
    <br><br><br>
{% endblock %}

{% block JsPage%}
<script>
    var msj = $('#error').val();
    if(msj.length > 0)
    {
        M.toast({ html: msj, classes: 'rounded Orangelogyca' })
    }

    $(document).ready(function(){        
        M.textareaAutoResize($('#observation'));
        var nit = $('#nit').val();
        
        $("#prefixTable").html("");
        $.ajax({
            url: "{% url 'ajax_load_prefixtable' opc=4 %}",
            data: {'nit': nit},
            success:function(result){
                $("#prefixTable").html(result);
            },
        });
    });
</script>
{% endblock%}